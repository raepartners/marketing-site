---
interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;

// Company logos - companies where our team has built orgs and AI
// height: per-logo sizing for visual balance (default h-10)
// width: per-logo width for proper aspect ratio display
const logos = [
  { name: 'Cisco', src: '/images/logos/cisco.svg', height: 'h-12', width: 'w-24' },
  { name: 'Twilio', src: '/images/logos/twilio.svg', height: 'h-12', width: 'w-40' },
  { name: 'Uber', src: '/images/logos/uber.svg', width: 'w-28' },
  { name: 'Indeed', src: '/images/logos/indeed.svg', width: 'w-36' },
  { name: 'Berkeley SkyDeck', src: '/images/logos/berkeley-skydeck.svg', height: 'h-8', width: 'w-[365px]' },
  { name: 'RetailMeNot', src: '/images/logos/retailmenot.svg', width: 'w-56' },
  { name: 'ComPsych', src: '/images/logos/compsych.svg', width: 'w-56' },
  { name: 'Adept', src: '/images/logos/adept.svg', width: 'w-60' },
];
---

<section class:list={['logo-marquee-section py-16 overflow-hidden', className]}>
  <div class="max-w-4xl mx-auto px-6 mb-8">
    <p class="text-center text-sm text-muted-foreground uppercase tracking-wider">
      Companies where our team has built orgs and AI
    </p>
  </div>

  <div class="logo-marquee-container relative">
    <!-- Fade edges - use CSS variable directly for proper color matching -->
    <div class="fade-edge-left absolute left-0 top-0 bottom-0 w-24 z-10 pointer-events-none" />
    <div class="fade-edge-right absolute right-0 top-0 bottom-0 w-24 z-10 pointer-events-none" />

    <!-- Scrolling track -->
    <div class="logo-marquee-track flex items-center gap-16">
      {/* First set of logos */}
      {logos.map((logo) => (
        <div class:list={["logo-item flex-shrink-0 flex items-center justify-center", logo.height || 'h-10']}>
          <div class:list={["logo-mask h-full opacity-50 hover:opacity-80 transition-opacity", logo.width || 'w-28']} style={`-webkit-mask-image: url(${logo.src}); mask-image: url(${logo.src});`} role="img" aria-label={logo.name}></div>
        </div>
      ))}
      {/* Duplicate for seamless loop */}
      {logos.map((logo) => (
        <div class:list={["logo-item flex-shrink-0 flex items-center justify-center", logo.height || 'h-10']} aria-hidden="true">
          <div class:list={["logo-mask h-full opacity-50 hover:opacity-80 transition-opacity", logo.width || 'w-28']} style={`-webkit-mask-image: url(${logo.src}); mask-image: url(${logo.src});`}></div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  /* Section background - use exact same oklch as --background in global.css */
  .logo-marquee-section {
    background-color: oklch(0.985 0.008 85);
  }

  :global(.dark) .logo-marquee-section {
    background-color: oklch(0.18 0.015 50);
  }

  /* Animation speed scales inversely with screen width - smaller screens need faster scroll */
  .logo-marquee-track {
    animation: marquee 6s linear infinite; /* Small mobile - fastest */
  }

  @media (min-width: 480px) {
    .logo-marquee-track {
      animation-duration: 10s; /* Mobile */
    }
  }

  @media (min-width: 640px) {
    .logo-marquee-track {
      animation-duration: 16s; /* Tablet */
    }
  }

  @media (min-width: 1024px) {
    .logo-marquee-track {
      animation-duration: 24s; /* Desktop */
    }
  }

  @media (min-width: 1280px) {
    .logo-marquee-track {
      animation-duration: 30s; /* Large desktop */
    }
  }

  .logo-marquee-container:hover .logo-marquee-track {
    animation-play-state: paused;
  }

  @keyframes marquee {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }

  /* Fade edges - interpolate in oklch to same color with 0 alpha */
  .fade-edge-left {
    background: linear-gradient(in oklch to right, oklch(0.985 0.008 85), oklch(0.985 0.008 85 / 0));
  }

  .fade-edge-right {
    background: linear-gradient(in oklch to left, oklch(0.985 0.008 85), oklch(0.985 0.008 85 / 0));
  }

  :global(.dark) .fade-edge-left {
    background: linear-gradient(in oklch to right, oklch(0.18 0.015 50), oklch(0.18 0.015 50 / 0));
  }

  :global(.dark) .fade-edge-right {
    background: linear-gradient(in oklch to left, oklch(0.18 0.015 50), oklch(0.18 0.015 50 / 0));
  }

  /* Logo colors using mask technique */
  .logo-mask {
    /* Light mode: bright golden sun color ~oklch(0.80 0.18 80) */
    background-color: #D4A030;
    -webkit-mask-size: contain;
    mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-position: center;
  }

  :global(.dark) .logo-mask {
    /* Dark mode: deeper golden ~oklch(0.65 0.15 80) */
    background-color: #B08020;
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .logo-marquee-track {
      animation: none;
    }
  }
</style>
